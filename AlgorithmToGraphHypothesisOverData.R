##### INPUT VALUES (to be changed on each test case)
data_collection <- c(37651.280325,37334.022311,41786.0853441,35549.277677,44061.2959436,37153.6161984,38131.8703726,40954.1725345,36284.8542222,38245.2457518,43626.4093673,36806.773349,18797.824778,18246.5223988,18341.1971761,17986.5075861,18128.2553709,19860.3594366,17788.4134623,18064.1397628,18037.5228805,19200.1999407,18876.33921,17679.5568176,14632.6690472,14590.0445458,15550.7831082,15590.2961937,15516.7446321,15221.9029883,14630.3805451,16533.8092573,15502.2373273,14868.2745575,15166.4561015,15597.8742896,27816.1272351,30725.6386805,26428.4761997,30862.7457126,31283.8670684,30948.6780598,29815.7231679,25953.6746276,31933.1345342,31771.5887412,31798.4003437,31016.337699,23763.1299285,21395.4776775,22980.2355245,21155.5442007,24090.0509136,23299.2871336,23215.6834009,24605.2160341,21167.3592863,24364.1041682,24531.1824923,24301.2313044,19801.8209384,15599.2516698,19834.4003094,15255.308564,17952.9479313,14919.5107713,15471.0618599,19221.6826062,17885.4109545,13948.6170075,16212.4283154,17674.4738795,31075.828004,34699.1842333,30402.8624361,23894.3454056,29169.2738344,21230.2939847,22501.4879124,26355.0867016,24590.8511343,30561.0730458,24758.281486,36849.2139347,12961.8398716,14320.6892483,13948.5018204,12968.6805044,12939.5901014,14626.5632351,15312.4408602,13477.6738566,14773.0753194,15708.6194379,14659.8309965,14918.6248508,14881.9658828,15094.1524535,14821.6441661,14302.6761339,14485.1708992,13831.2955695,13105.8219127,12720.8740035,13017.80609,12992.4634397,14033.8316623,13810.8833693,34575.7282923,43269.0633577,51709.2960958,52737.2887289,52943.1565653,41386.2729075,34381.5535783,50858.4463998,48075.2114878,46652.1715689,51501.9947354,46723.8008306,63815.046734,50290.312427,54635.8495926,67160.4893815,54358.6296454,60550.8079179,55457.0822736,68674.9061058,47631.4962378,59142.9801042,51330.4757744,42966.0473803,48501.954923,54530.8160958,39691.6887249,45811.2959406,39869.5869376,49563.6778877,39807.5664241,49666.0840138,47333.0085365,41684.4182532,50683.695678,48056.1984623,47839.8847652,41404.3427576,41762.7528871,47050.4370187,45171.8454614,41322.4478059,38952.2062636,46601.4500059,48076.7342344,37935.3672905,38597.210101,51172.6367985,79871.8192405,66940.6985158,67208.5783398,71889.8591282,54840.7584628,62534.3466569,55228.3276594,68939.0844654,73547.2854629,79502.167305,78160.7415767,68472.7792354,77602.8529364,50199.6674834,57450.6280957,78466.6610902,66199.7121771,50651.112995,48381.7306212,66794.1170615,64313.3412822,57121.3464351,62611.5500723,53409.5541012,69039.0484055,69391.1017517,62156.7856616,86790.781397,66151.4497119,80844.287841,64087.0509265,64569.2573982,80816.3701637,70800.3920833,77392.3952886,67456.8326717,77586.1394612,72383.6294796,78165.2832985,71344.3303859,82654.4861941,79615.8933663,58051.0182572,64869.5004206,70466.6025114,63683.0937171,82788.7607824,78843.3441735,69028.0969186,61649.8117247,85345.5984172,77507.9708439,85103.1384728,61953.8749864,73638.3941184,79911.5772271,81646.732678,85177.4240934,68105.6933688,73653.9715456,66355.1307039,81229.0334794,86955.9555675,86241.5396522,83977.1150245,67569.2962313,65502.541632,79460.2480565,64141.896472,63380.6238081,63119.7479623,65757.1463343,48461.7738922,64080.0968253,58032.2113954,56595.7324344,67361.362806,49376.1514563,53155.4029597,55588.8497776,67973.2432033,53354.9277885,69354.3776934,63465.8386222,61586.2890079,58907.8771157,70483.3214547,73299.8550662,66790.1690032,74775.4712926,60726.4587944,73308.3656306,68274.731668,65517.8371343,61794.3871948,61884.3074734,44999.3343169,42539.4407916,57603.7046596,46660.5326811,52273.7490418,42843.4091882,42936.5538258,48208.2114264,46267.2173766,42367.3430464,45670.2183558,45563.2769893,46339.7475991,52661.9931621,54258.5722756,46426.1961742,45779.8013143,62400.32832,54218.8825914,61295.4445068,48882.4069353,58806.2292907,48826.9663383,53537.3714737,34276.3739733,37100.8488767,38526.2475817,35988.3884665,32180.7941784,37899.3986465,32768.490076,34560.7703727,34997.9203485,36855.9382519,37261.3991108,39241.522678);
time <- c(1396584000,1396584300,1396584600,1396584900,1396585200,1396585500,1396585800,1396586100,1396586400,1396586700,1396587000,1396587300,1396587600,1396587900,1396588200,1396588500,1396588800,1396589100,1396589400,1396589700,1396590000,1396590300,1396590600,1396590900,1396591200,1396591500,1396591800,1396592100,1396592400,1396592700,1396593000,1396593300,1396593600,1396593900,1396594200,1396594500,1396594800,1396595100,1396595400,1396595700,1396596000,1396596300,1396596600,1396596900,1396597200,1396597500,1396597800,1396598100,1396598400,1396598700,1396599000,1396599300,1396599600,1396599900,1396600200,1396600500,1396600800,1396601100,1396601400,1396601700,1396602000,1396602300,1396602600,1396602900,1396603200,1396603500,1396603800,1396604100,1396604400,1396604700,1396605000,1396605300,1396605600,1396605900,1396606200,1396606500,1396606800,1396607100,1396607400,1396607700,1396608000,1396608300,1396608600,1396608900,1396609200,1396609500,1396609800,1396610100,1396610400,1396610700,1396611000,1396611300,1396611600,1396611900,1396612200,1396612500,1396612800,1396613100,1396613400,1396613700,1396614000,1396614300,1396614600,1396614900,1396615200,1396615500,1396615800,1396616100,1396616400,1396616700,1396617000,1396617300,1396617600,1396617900,1396618200,1396618500,1396618800,1396619100,1396619400,1396619700,1396620000,1396620300,1396620600,1396620900,1396621200,1396621500,1396621800,1396622100,1396622400,1396622700,1396623000,1396623300,1396623600,1396623900,1396624200,1396624500,1396624800,1396625100,1396625400,1396625700,1396626000,1396626300,1396626600,1396626900,1396627200,1396627500,1396627800,1396628100,1396628400,1396628700,1396629000,1396629300,1396629600,1396629900,1396630200,1396630500,1396630800,1396631100,1396631400,1396631700,1396632000,1396632300,1396632600,1396632900,1396633200,1396633500,1396633800,1396634100,1396634400,1396634700,1396635000,1396635300,1396635600,1396635900,1396636200,1396636500,1396636800,1396637100,1396637400,1396637700,1396638000,1396638300,1396638600,1396638900,1396639200,1396639500,1396639800,1396640100,1396640400,1396640700,1396641000,1396641300,1396641600,1396641900,1396642200,1396642500,1396642800,1396643100,1396643400,1396643700,1396644000,1396644300,1396644600,1396644900,1396645200,1396645500,1396645800,1396646100,1396646400,1396646700,1396647000,1396647300,1396647600,1396647900,1396648200,1396648500,1396648800,1396649100,1396649400,1396649700,1396650000,1396650300,1396650600,1396650900,1396651200,1396651500,1396651800,1396652100,1396652400,1396652700,1396653000,1396653300,1396653600,1396653900,1396654200,1396654500,1396654800,1396655100,1396655400,1396655700,1396656000,1396656300,1396656600,1396656900,1396657200,1396657500,1396657800,1396658100,1396658400,1396658700,1396659000,1396659300,1396659600,1396659900,1396660200,1396660500,1396660800,1396661100,1396661400,1396661700,1396662000,1396662300,1396662600,1396662900,1396663200,1396663500,1396663800,1396664100,1396664400,1396664700,1396665000,1396665300,1396665600,1396665900,1396666200,1396666500,1396666800,1396667100,1396667400,1396667700,1396668000,1396668300,1396668600,1396668900,1396669200,1396669500,1396669800,1396670100);
fecha <- "Data from: September 2014, averaged to a single day"
title <- "Time vs Output Flow with Hypothesis Overlay"
type_of_data <- "Output Flow"

##### VARIABLES USED TO MODIFY THE FORMULA(S)
fragment_M_percent <- 30.00 #PERCENT OF MAXIMUM VALUES TO BE AVERAGED
fragment_m_percent <- 30.00 #PERCENT OF MINIMUM VALUES TO BE AVERAGED
interval <- 4 #SPACE OF TOLERANCE
alpha <- 0.59 #Value in range [0,2) that displaces the graph horizontally
stretch <- 1 #KEEP AT 1, unless graph is missbehaving
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

##### FORMATTING THE TIME FOR BETTER USE OF THE FORMULA
formatted_time <- time - min(time)

##### PLOTING DATA AS IT IS
plot(formatted_time, data_collection, main = title,
     sub = fecha,
     xlab = "Seconds on a day",
     ylab = type_of_data)

##### SETTING VARIABLES FOR THE FORMULA
#Get a fragment of the data to set the Maximum/minimum value of the formula and
#take their average
data_sorted <- sort(data_collection)
fragment_M <- fragment_M_percent /100
fragment_m <- fragment_m_percent /100
maxes <- tail(data_sorted,length(data_sorted)*fragment_M)
mines <- head(data_sorted,length(data_sorted)*fragment_m)
M <- mean(maxes)
m <- mean(mines)
a <- alpha
seconds <- max(formatted_time)

##### CREATING THE FORMULA AND OVERLAYING THE LINE OVER THE DATA
fun <- (cos((pi * formatted_time)/(seconds*stretch/2) + a*pi) * (M-m) + (M+m))/2
lines(formatted_time, fun, col='green')

fun1 <- fun + (interval * ((M-m)/40))
lines(formatted_time, fun1, col='greenyellow')

fun2 <- fun + (interval * 2 * ((M-m)/40))
lines(formatted_time, fun2, col='yellow')

fun3 <- fun + (interval * 3 * ((M-m)/40))
lines(formatted_time, fun3, col='orange')

fun4 <- fun + (interval * 4 * ((M-m)/40))
lines(formatted_time, fun4, col='red')

fun5 <- fun - (interval * ((M-m)/40))
lines(formatted_time, fun5, col='greenyellow')

fun6 <- fun - (interval * 2 * ((M-m)/40))
lines(formatted_time, fun6, col='yellow')

fun7 <- fun - (interval * 3 * ((M-m)/40))
lines(formatted_time, fun7, col='orange')

fun8 <- fun - (interval * 4 * ((M-m)/40))
lines(formatted_time, fun8, col='red')